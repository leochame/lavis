## Lavis 用户使用说明

> 本文面向 **最终用户**，帮助你在 macOS 上安装、启动和日常使用 Lavis AI 智能体。

---

## 1. 系统要求

- **操作系统**: macOS（支持 Intel 与 Apple Silicon）
- **网络**: 稳定的网络连接，用于访问云端 LLM / 语音服务
- **后台服务**:
  - 已安装并运行的 Lavis 后端（Spring Boot 应用，推荐使用 GraalVM Native Image 打包版本，具体见开发者文档）
  - 默认端口为 `8080`，如有修改，请在前端配置中更新

---

## 2. 安装与启动

### 2.1 安装 Electron 桌面应用

- 双击安装包（如 `Lavis AI-1.0.0-arm64.dmg`），将 `Lavis AI.app` 拖入「应用程序」文件夹。
- 首次打开时，如果出现「无法验证开发者」提示，请在「系统设置 -> 隐私与安全性」中允许运行该应用。

### 2.2 启动后端服务

- 后端可以以普通 JAR 形式或 GraalVM Native Image 二进制形式运行（具体见开发者打包指南）。
- 启动成功后，在浏览器中访问 `http://localhost:8080/api/agent/status` 应该返回系统状态 JSON。

### 2.3 授予 macOS 权限

首次运行 Lavis 时，请按提示授予以下权限：

- **屏幕录制**: 用于视觉感知当前屏幕内容。
- **辅助功能**: 用于模拟鼠标键盘操作。

路径：`系统设置 -> 隐私与安全性 -> 屏幕录制 / 辅助功能`，在列表中勾选 `Lavis AI`。

---

## 3. 首次配置

### 3.1 配置 LLM 与语音服务

- Lavis 需要若干 API Key（如通用 LLM、视觉 LLM、语音识别、语音合成等）。
- 推荐将这些 Key 配置在后端的环境变量或 `application.properties` 文件中，前端无需直接接触密钥。

### 3.2 前端与后端连通性

- 启动 `Lavis AI.app` 后，胶囊组件应显示为「就绪」状态（蓝色渐变静止）。
- 如果后端未运行或连接失败，胶囊会显示为「错误」状态（红色脉冲）。

---

## 4. 基本使用方式

### 4.1 窗口形态

- **Idle**：休眠状态，仅在菜单栏或托盘中驻留。
- **Listening**：语音唤醒/监听中，小尺寸胶囊窗口，仅显示轻量反馈。
- **Expanded**：展开完整界面，展示聊天区与任务工作流。

### 4.2 唤醒与快捷键

- 通过唤醒词（如「Hi Lavis」）或快捷键唤醒：
  - `Alt + Space`：显示/隐藏胶囊或聊天窗口
  - `Cmd + K`：快速打开聊天
  - `Escape`：隐藏窗口
- 双击胶囊可在 Listening 与 Expanded 之间切换。

### 4.3 典型操作示例

- 「帮我打开 Safari 并搜索今天的天气」
- 「把当前屏幕上显示的错误信息读给我听」
- 「打开微信并给张三发消息：今晚 8 点见」

---

## 5. 安全与隐私

- 所有屏幕截图和自动化操作在本地完成，默认不上传到第三方。
- 截图仅用于实时视觉分析，旧的截图会自动清理，以避免长时间运行导致内存泄漏。
- API Key 仅保存在本地配置文件或环境变量中，不会被应用上传。

---

## 6. 常见问题（FAQ）

### Q1. 胶囊一直是红色，表示什么？

通常表示后端不可用或连接失败，请确认后端服务已启动，并检查网络与端口。

### Q2. 鼠标键盘没有反应？

请检查是否在「隐私与安全性 -> 辅助功能」中勾选了 `Lavis AI`，并重启应用。

### Q3. 语音不能正常工作？

请检查麦克风权限、网络连接以及后端语音服务配置（ASR/TTS 的 API Key 是否有效）。

---

## 7. 获取帮助

- 如果你在使用过程中遇到问题，可以：
  - 查看根目录下的 `README.md` 和 `docs/ARCHITECTURE.md`
  - 向项目维护者提交 Issue（若已开源）


